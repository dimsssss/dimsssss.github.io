---
title: "17.힙, 스택 메모리 할당"
date: 2024-09-27T13:27:48+09:00
categories: 
    - 프로그래밍 언어
tags:
    - C
    - learn c the hard way
---

힙과 스택의 구분은 간단하게 함수를 선언하고 내부에 있는 값들은 전부 스택에 존재하고 **malloc**을 이용하여 생성한 경우 힙 공간에 생성된다.

주의할 점은 함수 내부에서 생성한 값들은 함수가 마지막 코드를 실행하면 전부 사라지기 때문에 함수 내부에서 힙을 사용해 데이터를 저장하고 그 포인터를 다른 함수에 넘겨줄 때  `segmentation fault`가 발생할 수 있다. 포인터도 함수가 종료될 때 사라지기 때문에 죽은 공간을 가리키게 된다.

### 스택과 힙 비교

| 비교 항목         | **스택(Stack)**            | **힙(Heap)**              |
| ------------- | ------------------------ | ------------------------ |
| **메모리 할당 방식** | 정적 할당 (LIFO 방식)          | 동적 할당 (프로그래머가 제어)        |
| **속도**        | 매우 빠름 (자동 해제)            | 느림 (수동 해제)               |
| **메모리 크기**    | 제한적 (보통 수 MB, 고정 크기)     | 제한 없음 (시스템 가용 메모리만큼)     |
| **관리**        | 자동 (컴파일러에 의해 관리됨)        | 수동 (프로그래머가 직접 관리)        |
| **수명**        | 지역적 (함수 실행 중에만 유효)       | 글로벌 (수동으로 해제하기 전까지 유지)   |
| **주 용도**      | 지역 변수, 함수 호출 시 인자        | 동적 데이터 구조, 런타임 크기 결정 데이터 |
| **메모리 오버플로우** | 스택 오버플로우 가능 (할당 크기 초과 시) | 메모리 누수 가능 (해제하지 않으면)     |

